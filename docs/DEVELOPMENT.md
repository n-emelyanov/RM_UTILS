# Инструкция по разработке и внесению изменений в библиотеку

## Общие принципы
Библиотека использует модель разработки Git Flow с некоторыми упрощениями. Все изменения вносятся через ветки, что обеспечивает чистоту основной ветки и позволяет организовать эффективный процесс code review.

## Ветки
- **master** — стабильная версия для production
- **develop** — основная ветка для разработки
- **feature/** — ветки для разработки новой функциональности

## Процесс внесения изменений
### 1. Подготовка к разработке
Убедитесь, что у вас установлены все необходимые зависимости.

#### 1.1. Установите Poetry, если еще не установлен:
```bash
# Ubuntu/Debian
sudo apt install poetry

# MacOS (Homebrew)
brew install poetry

# Windows (PowerShell)
(Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | python -

```

#### 1.2. Загрузите проект:
```bash
# Клонируйте репозиторий
git clone git@github.com:n-emelyanov/RM_UTILS.git
cd RM_UTILS

# Установите зависимости
poetry install
```

### 2. Создание новой ветки для разработки
Всегда начинайте работу с создания новой ветки от develop:
```bash
# Обновите локальную ветку develop
git checkout develop
git pull origin develop

# Создайте новую feature-ветку
git checkout -b feature/краткое-описание-изменения
```

### 3. Фиксация изменения
```bash
git add .
git commit -m "feat: Добавлен новый расчет метрики"

# Доступные префиксы:
# feat:     новая функциональность
# fix:      исправление бага
# docs:     изменения в документации
# style:    форматирование, отсутствие изменений в логике
# refactor: рефакторинг кода
# test:     добавление или исправление тестов
# chore:    обновление зависимостей, конфигураций
```

### 3. Подготовка к PR
#### 3.1. Обновление версии
Если изменения затрагивают API, обновите версию в `pyproject.toml` согласно SemVer:

* MAJOR — обратно несовместимые изменения
* MINOR — обратно совместимые нововведения
* PATCH — обратно совместимые исправления

#### 3.2. Добавление Examples
При добавлении нового функционала следует добавить пример его использования в директорию `examples/`

#### 3.3. Обновление feature-ветки

Если во время вашей работы в develop внесли изменения, актуализируйте feature-ветку.

##### 3.3.1. Через Rebase (предпочтительно):
```bash
git checkout ваша-feature-ветка

# Получаем свежие данные
git fetch origin

# Перемещаем ваши коммиты на вершину develop
git rebase origin/develop
```

##### 3.3.2. Через Merge (альтернатива):
```bash
git checkout ваша-feature-ветка
git merge origin/develop            # добавляет merge-коммит
```

### 4. Создание PR в GitHub

1) Перейдите на страницу репозитория в GitHub;
2) Нажмите "Compare & pull request";
3) Укажите:
    * Целевую ветку: `develop`;
    * Заполните шаблон PR;
    * Добавьте ревьюверов.

### 5. Процесс ревью

1) Дождитесь одобрения от назначенных ревьюверов;
2) Устраните замечания, если они есть;
3) Обновите ветку через rebase при необходимости.


### 6. Слияние изменений
После утверждения PR:

- Используйте опцию "Squash and merge" для feature-веток;
- Удалите ветку после слияния.
